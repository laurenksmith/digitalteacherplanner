{% extends "base.html" %}

{% block title %}Weekly Planner{% endblock %}

{% block content %}
<h1>Week of {{ start.strftime('%d %B %Y') }} – {{ end.strftime('%d %B %Y') }}</h1>

{% if upcoming_tasks %}
    <h2>Upcoming Tasks (Next Week)</h2>
    <ul>
        {% for task in upcoming_tasks %}
            <li>
                <strong>{{ task.title }}</strong> – {{ task.date }}<br>
                {{ task.notes }}
            </li>
        {% endfor %}
    </ul>
{% endif %}

<div class="nav">
    <a href="{{ url_for('week_view', date=(start - timedelta(days=7)).isoformat()) }}">
        <i class="fas fa-arrow-left"></i> Previous Week
    </a>
    <a href="{{ url_for('week_redirect') }}">
        <i class="fas fa-calendar-day"></i> This Week
    </a>
    <a href="{{ url_for('week_view', date=(start + timedelta(days=7)).isoformat()) }}">
        Next Week <i class="fas fa-arrow-right"></i>
    </a>
</div>

{% for date_str, events in week_events.items() %}
    <div class="day">
        <div class="date-label">{{ date_str | datetimeformat('%A, %d %B %Y') }}</div>
        {% if events %}
            {% for event in events %}
                <div class="event">
                    <strong>{{ event.title }}</strong><br>
                    <small>{{ event.notes }}</small><br>
                    <a href="{{ url_for('edit_event', event_id=event.id) }}">Edit</a> |
                    <a href="{{ url_for('delete_event', event_id=event.id) }}" onclick="return confirm('Are you sure?')">Delete</a>
                </div>
            {% endfor %}
        {% else %}
            <p>No events</p>
        {% endif %}
    </div>
{% endfor %}

<p><a href="{{ url_for('index') }}">Back to homepage</a></p>
{% endblock %}

